<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LibSpindle-C-Library: C:/HomeGit/STM32/libs/LibSpindle/src/Spindle.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="banner.png"/></td>
  <td id="projectalign">
   <div id="projectname">LibSpindle-C-Library<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">Library Code documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('Spindle_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">Spindle.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="Spindle_8h_source.html">Spindle.h</a>&quot;</code><br />
<code>#include &quot;FreeRTOS.h&quot;</code><br />
<code>#include &quot;task.h&quot;</code><br />
<code>#include &quot;semphr.h&quot;</code><br />
<code>#include &quot;queue.h&quot;</code><br />
<code>#include &quot;timers.h&quot;</code><br />
<code>#include &lt;malloc.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;sys/queue.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for Spindle.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="Spindle_8c__incl.png" border="0" usemap="#aC_1_2HomeGit_2STM32_2libs_2LibSpindle_2src_2Spindle_8c" alt=""/></div>
<map name="aC_1_2HomeGit_2STM32_2libs_2LibSpindle_2src_2Spindle_8c" id="aC_1_2HomeGit_2STM32_2libs_2LibSpindle_2src_2Spindle_8c">
<area shape="rect" title=" " alt="" coords="498,5,663,48"/>
<area shape="rect" href="Spindle_8h.html" title=" " alt="" coords="8,96,83,123"/>
<area shape="poly" title=" " alt="" coords="497,40,319,63,99,98,98,93,318,58,497,35"/>
<area shape="rect" title=" " alt="" coords="108,96,202,123"/>
<area shape="poly" title=" " alt="" coords="498,46,218,98,217,93,497,41"/>
<area shape="rect" title=" " alt="" coords="226,96,284,123"/>
<area shape="poly" title=" " alt="" coords="498,49,299,98,298,93,497,44"/>
<area shape="rect" title=" " alt="" coords="308,96,383,123"/>
<area shape="poly" title=" " alt="" coords="521,51,398,93,396,88,519,46"/>
<area shape="rect" title=" " alt="" coords="408,96,475,123"/>
<area shape="poly" title=" " alt="" coords="546,51,477,90,475,86,543,46"/>
<area shape="rect" title=" " alt="" coords="499,96,568,123"/>
<area shape="poly" title=" " alt="" coords="570,50,551,84,546,81,566,47"/>
<area shape="rect" title=" " alt="" coords="592,96,662,123"/>
<area shape="poly" title=" " alt="" coords="594,47,614,81,610,84,590,50"/>
<area shape="rect" title=" " alt="" coords="686,96,746,123"/>
<area shape="poly" title=" " alt="" coords="617,46,683,85,680,90,614,51"/>
<area shape="rect" title=" " alt="" coords="770,96,833,123"/>
<area shape="poly" title=" " alt="" coords="638,46,756,89,754,94,636,51"/>
<area shape="rect" title=" " alt="" coords="857,96,922,123"/>
<area shape="poly" title=" " alt="" coords="663,46,843,93,842,98,661,51"/>
<area shape="rect" title=" " alt="" coords="946,96,1038,123"/>
<area shape="poly" title=" " alt="" coords="664,41,931,93,930,98,663,46"/>
<area shape="rect" title=" " alt="" coords="1063,96,1124,123"/>
<area shape="poly" title=" " alt="" coords="664,34,837,56,1048,93,1047,98,836,62,663,39"/>
<area shape="rect" title=" " alt="" coords="5,171,86,197"/>
<area shape="poly" title=" " alt="" coords="48,123,48,155,43,155,43,123"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structStepCommandResponse.html">StepCommandResponse</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCtrlCommand.html">CtrlCommand</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstepSyncEventElement.html">stepSyncEventElement</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSpindleHandle.html">SpindleHandle</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a84d6e88d5f5a2262cab85f7b01da308c" id="r_a84d6e88d5f5a2262cab85f7b01da308c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a84d6e88d5f5a2262cab85f7b01da308c">ON_NULL_GOTO_ERROR</a>(x)</td></tr>
<tr class="separator:a84d6e88d5f5a2262cab85f7b01da308c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ab9469f67310100db1987fe18ebcc360e" id="r_ab9469f67310100db1987fe18ebcc360e"><td class="memItemLeft" align="right" valign="top"><a id="ab9469f67310100db1987fe18ebcc360e" name="ab9469f67310100db1987fe18ebcc360e"></a>
typedef struct <a class="el" href="structStepCommandResponse.html">StepCommandResponse</a>&#160;</td><td class="memItemRight" valign="bottom"><b>StepCommandResponse_t</b></td></tr>
<tr class="separator:ab9469f67310100db1987fe18ebcc360e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b5f3d87b69a55ec2e0d9a04ad4c5feb" id="r_a4b5f3d87b69a55ec2e0d9a04ad4c5feb"><td class="memItemLeft" align="right" valign="top"><a id="a4b5f3d87b69a55ec2e0d9a04ad4c5feb" name="a4b5f3d87b69a55ec2e0d9a04ad4c5feb"></a>
typedef struct <a class="el" href="structCtrlCommand.html">CtrlCommand</a>&#160;</td><td class="memItemRight" valign="bottom"><b>CtrlCommand_t</b></td></tr>
<tr class="separator:a4b5f3d87b69a55ec2e0d9a04ad4c5feb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a591d6189ba088ac905c2b9c9f316e015" id="r_a591d6189ba088ac905c2b9c9f316e015"><td class="memItemLeft" align="right" valign="top"><a id="a591d6189ba088ac905c2b9c9f316e015" name="a591d6189ba088ac905c2b9c9f316e015"></a>
typedef struct <a class="el" href="structstepSyncEventElement.html">stepSyncEventElement</a>&#160;</td><td class="memItemRight" valign="bottom"><b>stepSyncEventElement_t</b></td></tr>
<tr class="separator:a591d6189ba088ac905c2b9c9f316e015"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a6189838a6671dc5db0df1f6bf510a11c" id="r_a6189838a6671dc5db0df1f6bf510a11c"><td class="memItemLeft" align="right" valign="top"><a id="a6189838a6671dc5db0df1f6bf510a11c" name="a6189838a6671dc5db0df1f6bf510a11c"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><b>CtrlCommandType_t</b> { <b>cctNONE</b> = 0x00
, <b>cctSTART</b> = 0x01
, <b>cctSTOP</b> = 0x02
, <b>cctSTATUS</b> = 0x04
 }</td></tr>
<tr class="separator:a6189838a6671dc5db0df1f6bf510a11c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad24bb3638ab22c0452d60ceffcd48f85" id="r_ad24bb3638ab22c0452d60ceffcd48f85"><td class="memItemLeft" align="right" valign="top"><a id="ad24bb3638ab22c0452d60ceffcd48f85" name="ad24bb3638ab22c0452d60ceffcd48f85"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>SpindleFunction</b> (void *arg)</td></tr>
<tr class="separator:ad24bb3638ab22c0452d60ceffcd48f85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6ee3f41e654c1b1213dc0eadbf687e6" id="r_ae6ee3f41e654c1b1213dc0eadbf687e6"><td class="memItemLeft" align="right" valign="top"><a id="ae6ee3f41e654c1b1213dc0eadbf687e6" name="ae6ee3f41e654c1b1213dc0eadbf687e6"></a>
static SemaphoreHandle_t&#160;</td><td class="memItemRight" valign="bottom"><b>GetCommandEvent</b> (<a class="el" href="Spindle_8h.html#a3d7552ef760330fd6f48acef7e0aa9be">SpindleHandle_t</a> h)</td></tr>
<tr class="separator:ae6ee3f41e654c1b1213dc0eadbf687e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accad1421b1888224adeadd50c5ffaa1d" id="r_accad1421b1888224adeadd50c5ffaa1d"><td class="memItemLeft" align="right" valign="top"><a id="accad1421b1888224adeadd50c5ffaa1d" name="accad1421b1888224adeadd50c5ffaa1d"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>ReleaseCommandEvent</b> (<a class="el" href="Spindle_8h.html#a3d7552ef760330fd6f48acef7e0aa9be">SpindleHandle_t</a> h, SemaphoreHandle_t s)</td></tr>
<tr class="separator:accad1421b1888224adeadd50c5ffaa1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84ded3655ec1dffc4e46a3b8ac9a0722" id="r_a84ded3655ec1dffc4e46a3b8ac9a0722"><td class="memItemLeft" align="right" valign="top"><a id="a84ded3655ec1dffc4e46a3b8ac9a0722" name="a84ded3655ec1dffc4e46a3b8ac9a0722"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>SpindleConsoleFunction</b> (int argc, char **argv, void *ctx)</td></tr>
<tr class="separator:a84ded3655ec1dffc4e46a3b8ac9a0722"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0cea92a13bcdb91ed25de93f02c9744" id="r_ab0cea92a13bcdb91ed25de93f02c9744"><td class="memItemLeft" align="right" valign="top"><a id="ab0cea92a13bcdb91ed25de93f02c9744" name="ab0cea92a13bcdb91ed25de93f02c9744"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>SpindleRegisterBasicCommands</b> (<a class="el" href="Spindle_8h.html#a3d7552ef760330fd6f48acef7e0aa9be">SpindleHandle_t</a> h, ConsoleHandle_t cH)</td></tr>
<tr class="separator:ab0cea92a13bcdb91ed25de93f02c9744"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac853c2ad50f0e661cd06c2c68fe465d3" id="r_ac853c2ad50f0e661cd06c2c68fe465d3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="Spindle_8h.html#a3d7552ef760330fd6f48acef7e0aa9be">SpindleHandle_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac853c2ad50f0e661cd06c2c68fe465d3">SPINDLE_CreateInstance</a> (unsigned int uxStackDepth, int xPrio, ConsoleHandle_t cH, <a class="el" href="Spindle_8h.html#a668bd557de626b1ef65f4d756d58146c">SpindlePhysicalParams_t</a> *p)</td></tr>
<tr class="separator:ac853c2ad50f0e661cd06c2c68fe465d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a81e3db0fabe7b81208188d7eff4cb360" id="r_a81e3db0fabe7b81208188d7eff4cb360"><td class="memItemLeft" align="right" valign="top"><a id="a81e3db0fabe7b81208188d7eff4cb360" name="a81e3db0fabe7b81208188d7eff4cb360"></a>
static <a class="el" href="Spindle_8h.html#a3d7552ef760330fd6f48acef7e0aa9be">SpindleHandle_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>SpindleInstancePointer</b> = NULL</td></tr>
<tr class="separator:a81e3db0fabe7b81208188d7eff4cb360"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a84d6e88d5f5a2262cab85f7b01da308c" name="a84d6e88d5f5a2262cab85f7b01da308c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84d6e88d5f5a2262cab85f7b01da308c">&#9670;&#160;</a></span>ON_NULL_GOTO_ERROR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ON_NULL_GOTO_ERROR</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>x</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> { <span class="keywordflow">if</span> ((x) == NULL) <span class="keywordflow">goto</span> error; } <span class="keywordflow">while</span>(0);</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac853c2ad50f0e661cd06c2c68fe465d3" name="ac853c2ad50f0e661cd06c2c68fe465d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac853c2ad50f0e661cd06c2c68fe465d3">&#9670;&#160;</a></span>SPINDLE_CreateInstance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="Spindle_8h.html#a3d7552ef760330fd6f48acef7e0aa9be">SpindleHandle_t</a> SPINDLE_CreateInstance </td>
          <td>(</td>
          <td class="paramtype">unsigned int</td>          <td class="paramname"><span class="paramname"><em>uxStackDepth</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>xPrio</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ConsoleHandle_t</td>          <td class="paramname"><span class="paramname"><em>cH</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Spindle_8h.html#a668bd557de626b1ef65f4d756d58146c">SpindlePhysicalParams_t</a> *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The SPINDLE_CreateInstance function is used to create the spindle controller. There is a singleton pattern implemented for the controller so there is only one instance possible for the design. In case it is called multiple times, it returns the instance pointer of the first created spindle controller</p>
<p>The return value of SPINDLE_CreateInstance is a null pointer in case an error occured or a pointer of type <a class="el" href="Spindle_8h.html#a3d7552ef760330fd6f48acef7e0aa9be">SpindleHandle_t</a>.</p>
<p>param uxStackDepth is the stack depth of the console processor thread in words param xPrio is the spindle controller priority. param cH of type ConsoleHandle_t is the handle pointer of a console processor instance which is required to register the console command for the spindle controller param p of type SpindlePhysicalParams_t* is a pointer to the platform abstraction functions</p>
<p>ATTENTION: This function is not locked or guarded and therefore its never thread safe when calling from two different threads at the same or nearly the same time while no instance has been created before! One pointer and its ressources could be lost which leads to a memory leak and/or to console command registration issues at runtime when using the spindle command! </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="Spindle_8c.html">Spindle.c</a></li>
    <li class="footer">Generated on Mon Apr 14 2025 22:03:09 for LibSpindle-C-Library by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
